!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i(require("babylonjs"));else if("function"==typeof define&&define.amd)define(["babylonjs"],i);else{var s="object"==typeof exports?i(require("babylonjs")):i(t.BABYLON);for(var h in s)("object"==typeof exports?exports:t)[h]=s[h]}}(window,(function(t){return function(t){var i={};function s(h){if(i[h])return i[h].exports;var n=i[h]={i:h,l:!1,exports:{}};return t[h].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=i,s.d=function(t,i,h){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:h})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"h",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.h)return t;var h=Object.create(null);if(s.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)s.d(h,n,function(i){return t[i]}.bind(null,n));return h},s.n=function(t){var i=t&&t.h?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=1)}([function(i,s){i.exports=t},function(t,i,s){"use strict";s.r(i),s.d(i,"CharacterController",(function(){return n})),s.d(i,"ActionData",(function(){return r})),s.d(i,"ActionMap",(function(){return u})),s.d(i,"CCSettings",(function(){return f}));var h=s(0),n=function(){function t(t,i,s,n,r){var f=this;void 0===r&&(r=!1),this.u=null,this.v=null,this.k=9.8,this.M=30,this.j=45,this.O=Math.PI*this.M/180,this.g=Math.PI*this.j/180,this.C=.25,this.F=0,this.A=h.Vector3.Zero(),this.L=new u,this.R=!0,this.S=h.Vector3.Zero(),this.q=!1,this.B=0,this.J=0,this._=!1,this.D=-1,this.T=!1,this.G=!1,this.H=null,this.I=h.Vector3.Zero(),this.K=!1,this.N=0,this.P=50,this.U=0,this.V=!1,this.W=!1,this.X=!1,this.Y=0,this.Z=0,this.$=0,this.tt=1,this.it=!1,this.st=!1,this.ht=0,this.nt=0,this.et=10,this.rt=!0,this.ut=!1,this.ft=new h.Ray(h.Vector3.Zero(),h.Vector3.One(),1),this.ot=h.Vector3.Zero(),this.ct=.5,this.lt=new Array,this.vt=!1,this.bt=50,this.wt=!1,this.kt=!1,this.Mt=!1,this.dt=i,this.pt=s,this.setAvatar(t,r)||console.error("unable to set avatar");null!=n&&this.setActionMap(n),this.kt||null==this.v||this.jt(this.v),this.kt,this.rt=this.dt.checkCollisions,this.yt=new e,this.Ot=function(){f.gt()},this.xt=function(t){f.Ct(t)},this.Ft=function(t){f.At(t)}}return t.prototype.getScene=function(){return this.pt},t.prototype.setSlopeLimit=function(t,i){this.M=t,this.j=i,this.O=Math.PI*this.M/180,this.g=Math.PI*this.j/180},t.prototype.setStepOffset=function(t){this.C=t},t.prototype.setWalkSpeed=function(t){this.L.walk.speed=t},t.prototype.setRunSpeed=function(t){this.L.run.speed=t},t.prototype.setBackSpeed=function(t){this.L.walkBack.speed=t},t.prototype.setBackFastSpeed=function(t){this.L.walkBackFast.speed=t},t.prototype.setJumpSpeed=function(t){this.L.idleJump.speed=t,this.L.runJump.speed=t},t.prototype.setLeftSpeed=function(t){this.L.strafeLeft.speed=t},t.prototype.setLeftFastSpeed=function(t){this.L.strafeLeftFast.speed=t},t.prototype.setRightSpeed=function(t){this.L.strafeRight.speed=t},t.prototype.setRightFastSpeed=function(t){this.L.strafeLeftFast.speed=t},t.prototype.setTurnSpeed=function(t){this.L.turnLeft.speed=t*Math.PI/180,this.L.turnRight.speed=t*Math.PI/180},t.prototype.setTurnFastSpeed=function(t){this.L.turnLeftFast.speed=t*Math.PI/180,this.L.turnRightFast.speed=t*Math.PI/180},t.prototype.setGravity=function(t){this.k=t},t.prototype.setAnimationGroups=function(t){null!=this.H&&this.H.exist&&this.H.ag.stop(),this.kt=!0,this.setActionMap(t)},t.prototype.setAnimationRanges=function(t){this.kt=!1,this.setActionMap(t)},t.prototype.setActionMap=function(t){for(var i,s=!1,n=0,e=Object.keys(this.L);n<e.length;n++){var u=e[n],f=this.L[u];f instanceof r&&(f.exist=!1,null!=(i=t[f.id])&&(i instanceof h.AnimationGroup?(f.ag=i,f.name=f.ag.name,f.exist=!0,s=!0,this.Mt=!0):i.exist&&(this.Mt=!0,f.exist=!0,i instanceof Object?(i.ag&&(f.ag=i.ag,s=!0),i.name&&(f.name=i.name),null!=i.loop&&(f.loop=i.loop),i.rate&&(f.rate=i.rate),i.speed&&(f.speed=i.speed),i.sound&&(f.sound=i.sound)):f.name=i)))}return this.Lt(),this.H=null,s?"ag":"ar"},t.prototype.getActionMap=function(){for(var t=new u,i=0,s=Object.keys(this.L);i<s.length;i++){var h=s[i],n=this.L[h];if(n instanceof r&&n.exist){var e=t[n.id];e.ag=n.ag,e.name=n.name,e.loop=n.loop,e.rate=n.rate,e.speed=n.speed,e.key=n.key,e.sound=n.sound,e.exist=n.exist}}return t},t.prototype.getSettings=function(){var t=new f;return t.faceForward=this.isFaceForward(),t.topDown=1==this.getMode(),t.turningOff=this.isTurningOff(),t.cameraTarget=this.S.clone(),t.cameraElastic=this.R,t.elasticSteps=this.bt,t.makeInvisble=this.vt,t.gravity=this.k,t.keyboard=this.Rt,t.maxSlopeLimit=this.j,t.minSlopeLimit=this.M,t.noFirstPerson=this.q,t.stepOffset=this.C,t},t.prototype.setSettings=function(t){this.setFaceForward(t.faceForward),this.setMode(t.topDown?1:0),this.setTurningOff(t.turningOff),this.setCameraTarget(t.cameraTarget),this.setCameraElasticity(t.cameraElastic),this.setElasticiSteps(t.elasticSteps),this.makeObstructionInvisible(t.makeInvisble),this.setGravity(t.gravity),this.enableKeyBoard(t.keyboard),this.setSlopeLimit(t.minSlopeLimit,t.maxSlopeLimit),this.setNoFirstPerson(t.noFirstPerson),this.setStepOffset(t.stepOffset)},t.prototype.St=function(t,i,s,n){if(this.kt||null!=this.v){if(null!=i)if(this.kt){if(!(i instanceof h.AnimationGroup))return;t.ag=i,t.exist=!0}else{if(null==this.v.getAnimationRange(t.name))return void(t.exist=!1);t.name=i,t.exist=!0}null!=n&&(t.loop=n),null!=s&&(t.rate=s)}},t.prototype.enableBlending=function(t){if(this.kt)for(var i=0,s=Object.keys(this.L);i<s.length;i++){var h=s[i],n=this.L[h];if(n instanceof r&&n.exist)for(var e=0,u=n.ag.targetedAnimations;e<u.length;e++){var f=u[e];f.animation.enableBlending=!0,f.animation.blendingSpeed=t}}else null!==this.v&&this.v.enableBlending(t)},t.prototype.disableBlending=function(){if(this.kt)for(var t=0,i=Object.keys(this.L);t<i.length;t++){var s=i[t],h=this.L[s];if(h instanceof r&&h.exist)for(var n=0,e=h.ag.targetedAnimations;n<e.length;n++){e[n].animation.enableBlending=!1}}},t.prototype.setWalkAnim=function(t,i,s){this.St(this.L.walk,t,i,s)},t.prototype.setRunAnim=function(t,i,s){this.St(this.L.run,t,i,s)},t.prototype.setWalkBackAnim=function(t,i,s){this.St(this.L.walkBack,t,i,s),this.qt(this.L.walkBackFast,this.L.walkBack)},t.prototype.setWalkBackFastAnim=function(t,i,s){this.St(this.L.walkBackFast,t,i,s)},t.prototype.setSlideBackAnim=function(t,i,s){this.St(this.L.slideBack,t,i,s)},t.prototype.setIdleAnim=function(t,i,s){this.St(this.L.idle,t,i,s)},t.prototype.setTurnRightAnim=function(t,i,s){this.St(this.L.turnRight,t,i,s),this.qt(this.L.turnRightFast,this.L.turnRight)},t.prototype.setTurnRightFastAnim=function(t,i,s){this.St(this.L.turnRightFast,t,i,s)},t.prototype.setTurnLeftAnim=function(t,i,s){this.St(this.L.turnLeft,t,i,s),this.qt(this.L.turnLeftFast,this.L.turnLeft)},t.prototype.setTurnLeftFastAnim=function(t,i,s){this.St(this.L.turnLeftFast,t,i,s)},t.prototype.setStrafeRightAnim=function(t,i,s){this.St(this.L.strafeRight,t,i,s),this.qt(this.L.strafeRightFast,this.L.strafeRight)},t.prototype.setStrafeRightFastAnim=function(t,i,s){this.St(this.L.strafeRightFast,t,i,s)},t.prototype.setStrafeLeftAnim=function(t,i,s){this.St(this.L.strafeLeft,t,i,s),this.qt(this.L.strafeLeftFast,this.L.strafeLeft)},t.prototype.setStrafeLeftFastAnim=function(t,i,s){this.St(this.L.strafeLeftFast,t,i,s)},t.prototype.setIdleJumpAnim=function(t,i,s){this.St(this.L.idleJump,t,i,s)},t.prototype.setRunJumpAnim=function(t,i,s){this.St(this.L.runJump,t,i,s)},t.prototype.setFallAnim=function(t,i,s){this.St(this.L.fall,t,i,s)},t.prototype.setWalkKey=function(t){this.L.walk.key=t.toLowerCase()},t.prototype.setWalkBackKey=function(t){this.L.walkBack.key=t.toLowerCase()},t.prototype.setTurnLeftKey=function(t){this.L.turnLeft.key=t.toLowerCase()},t.prototype.setTurnRightKey=function(t){this.L.turnRight.key=t.toLowerCase()},t.prototype.setStrafeLeftKey=function(t){this.L.strafeLeft.key=t.toLowerCase()},t.prototype.setStrafeRightKey=function(t){this.L.strafeRight.key=t.toLowerCase()},t.prototype.setJumpKey=function(t){this.L.idleJump.key=t.toLowerCase()},t.prototype.setCameraElasticity=function(t){this.R=t},t.prototype.setElasticiSteps=function(t){this.bt=t},t.prototype.makeObstructionInvisible=function(t){this.vt=t},t.prototype.setCameraTarget=function(t){this.S.copyFrom(t)},t.prototype.cameraCollisionChanged=function(){this.rt=this.dt.checkCollisions},t.prototype.setNoFirstPerson=function(t){this.q=t},t.prototype.jt=function(t){for(var i=0,s=Object.keys(this.L);i<s.length;i++){var h=s[i],n=this.L[h];n instanceof r&&(null!=t?null!=t.getAnimationRange(n.id)&&(n.name=n.id,n.exist=!0,this.Mt=!0):n.exist=!1)}this.Lt()},t.prototype.Lt=function(){this.qt(this.L.walkBackFast,this.L.walkBack),this.qt(this.L.turnRightFast,this.L.turnRight),this.qt(this.L.turnLeftFast,this.L.turnLeft),this.qt(this.L.strafeRightFast,this.L.strafeRight),this.qt(this.L.strafeLeftFast,this.L.strafeLeft)},t.prototype.qt=function(t,i){t.exist||i.exist&&(t.exist=!0,t.ag=i.ag,t.name=i.name,t.rate=2*i.rate)},t.prototype.setMode=function(t){this.B=t,this.J=t},t.prototype.getMode=function(){return this.B},t.prototype.setTurningOff=function(t){this.st=t},t.prototype.isTurningOff=function(){return this.st},t.prototype.Bt=function(t){var i=t.getWorldMatrix(),s=h.Vector3.FromFloatArray(i.m,0),n=h.Vector3.FromFloatArray(i.m,4),e=h.Vector3.FromFloatArray(i.m,8),r=h.Vector3.Cross(s,n);h.Vector3.Dot(r,e)<0?(this._=!0,this.D=1):(this._=!1,this.D=-1)},t.prototype.setFaceForward=function(t){this.Jt=t,this._?(this._t=t?Math.PI/2:3*Math.PI/2,this.Dt=t?1:-1):(this._t=t?3*Math.PI/2:Math.PI/2,this.Dt=t?-1:1)},t.prototype.isFaceForward=function(){return this.Jt},t.prototype.checkAGs=function(t){for(var i=0,s=Object.keys(this.L);i<s.length;i++){var h=s[i],n=this.L[h];n instanceof r&&(null!=t[n.name]&&(n.ag=t[n.name],n.exist=!0))}},t.prototype.Tt=function(t,i,s){var n;n=s?this.zt(t).getChildren((function(t){return t instanceof h.TransformNode}),!1):[t];for(var e=0,r=i;e<r.length;e++)for(var u=0,f=r[e].targetedAnimations;u<f.length;u++){var o=f[u];if(n.indexOf(o.target)>-1)return!0}return!1},t.prototype.zt=function(t){return null==t.parent?t:this.zt(t.parent)},t.prototype.start=function(){this.T||(this.T=!0,this.yt.reset(),this.$=0,this.ht=.001,this.K=!1,this.Et(),this.enableKeyBoard(!0),this.pt.registerBeforeRender(this.Ot))},t.prototype.stop=function(){this.T&&(this.T=!1,this.pt.unregisterBeforeRender(this.Ot),this.enableKeyBoard(!1),this.H=null)},t.prototype.pauseAnim=function(){this.G=!0},t.prototype.resumeAnim=function(){this.G=!1},t.prototype.Gt=function(){return h.Vector3.Dot(this.u.forward,this.u.position.subtract(this.dt.position))<0?1:-1},t.prototype.gt=function(){this.I.copyFrom(this.u.position);var t=null,i=this.pt.getEngine().getDeltaTime()/1e3;this.yt.Ht&&!this.V?(this.K=!1,this.ht=0,t=this.It(i)):this.anyMovement()||this.V?(this.K=!1,this.ht=0,t=this.Kt(i)):this.V||(t=this.Nt(i)),!this.G&&this.Mt&&null!=t&&this.H!==t&&(t.exist&&(this.kt?(null!=this.H&&this.H.exist&&this.H.ag.stop(),t.ag.start(t.loop,t.rate)):this.v.beginAnimation(t.name,t.loop,t.rate)),this.H=t),this.Et()},t.prototype.It=function(t){var i=null;i=this.L.runJump,0===this.Z&&(this.Y=this.u.position.y),this.Z=this.Z+t;var s,n=0,e=0;if(1==this.B||this.st||(this.u.rotation.y=this._t-this.dt.alpha),this.X||this.W?(this.X?n=this.L.run.speed*t:this.W&&(n=this.L.walk.speed*t),(s=this.Pt.clone()).y=0,(s=s.normalize()).scaleToRef(n,s),e=this.Qt(this.L.runJump.speed,t),s.y=e):(e=this.Qt(this.L.idleJump.speed,t),s=new h.Vector3(0,e,0),i=this.L.idleJump),this.u.moveWithCollisions(s),e<0)if(this.u.position.y>this.I.y||this.u.position.y===this.I.y&&s.length()>.001)this.Ut();else if(this.u.position.y<this.Y){var r=this.u.position.subtract(this.I);this.Vt(r,s,.001)?i=this.L.fall:this.Wt(r)<=this.O&&this.Ut()}return i},t.prototype.Qt=function(t,i){return(t-this.k*this.Z)*i-.5*this.k*i*i},t.prototype.Ut=function(){this.yt.Ht=!1,this.Z=0,this.W=!1,this.X=!1},t.prototype.Vt=function(t,i,s){return Math.abs(t.x-i.x)<s&&Math.abs(t.y-i.y)<s&&Math.abs(t.z-i.z)<s},t.prototype.Wt=function(t){return Math.atan(Math.abs(t.y/Math.sqrt(t.x*t.x+t.z*t.z)))},t.prototype.Kt=function(t){var i=this.$*this.k;this.N=i*t+this.k*t*t/2,this.$=this.$+t;var s=!1,h=null;if(this.V)this.Pt.y=-this.N,s=!0;else{this.W=!1,this.X=!1;var n=void 0,e=0;switch(!0){case this.yt.Xt:n=this.D*this.Gt(),e=this.L.strafeLeft.speed*t,this.yt.Yt?(e=this.L.strafeLeftFast.speed*t,h=-this.Dt*n>0?this.L.strafeLeftFast:this.L.strafeRightFast):h=-this.Dt*n>0?this.L.strafeLeft:this.L.strafeRight,this.Pt=this.u.calcMovePOV(n*e,-this.N,0),s=!0;break;case this.yt.Zt:n=-this.D*this.Gt(),e=this.L.strafeRight.speed*t,this.yt.Yt?(e=this.L.strafeRightFast.speed*t,h=-this.Dt*n>0?this.L.strafeLeftFast:this.L.strafeRightFast):h=-this.Dt*n>0?this.L.strafeLeft:this.L.strafeRight,this.Pt=this.u.calcMovePOV(n*e,-this.N,0),s=!0;break;case this.yt.$t||this.st&&0==this.B:this.yt.Yt?(this.X=!0,e=this.L.run.speed*t,h=this.L.run):(this.W=!0,e=this.L.walk.speed*t,h=this.L.walk),this.Pt=this.u.calcMovePOV(0,-this.N,this.Dt*e),s=!0;break;case this.yt.ti:e=this.L.walkBack.speed*t,this.yt.Yt?(e=this.L.walkBackFast.speed*t,h=this.L.walkBackFast):h=this.L.walkBack,this.Pt=this.u.calcMovePOV(0,-this.N,-this.Dt*e),s=!0}}if((!this.st||0!=this.B)&&!this.yt.Xt&&!this.yt.Zt&&(this.yt.ii||this.yt.si)){var r=this.L.turnLeft.speed*t;if(this.yt.Yt&&(r*=2),1==this.B){this.it||(this.tt=-this.Dt*this.Gt(),this._&&(this.tt=-this.tt),this.it=!0);var u=this.tt;this.yt.ii?this.yt.$t||(this.yt.ti?u=-this.tt:h=this.tt>0?this.L.turnRight:this.L.turnLeft):this.yt.$t?u=-this.tt:this.yt.ti||(u=-this.tt,h=this.tt>0?this.L.turnLeft:this.L.turnRight),this.u.rotation.y=this.u.rotation.y+r*u}else{u=1;this.yt.ii?(this.yt.ti&&(u=-1),s||(h=this.L.turnLeft)):(this.yt.$t&&(u=-1),s||(u=-1,h=this.L.turnRight)),this.dt.alpha=this.dt.alpha+r*u}}if(1!=this.B)if(this.st)switch(!0){case this.yt.$t&&this.yt.si:this.u.rotation.y=this._t-this.dt.alpha+Math.PI/4;break;case this.yt.$t&&this.yt.ii:this.u.rotation.y=this._t-this.dt.alpha-Math.PI/4;break;case this.yt.ti&&this.yt.si:this.u.rotation.y=this._t-this.dt.alpha+3*Math.PI/4;break;case this.yt.ti&&this.yt.ii:this.u.rotation.y=this._t-this.dt.alpha-3*Math.PI/4;break;case this.yt.$t:this.u.rotation.y=this._t-this.dt.alpha;break;case this.yt.ti:this.u.rotation.y=this._t-this.dt.alpha+Math.PI;break;case this.yt.si:this.u.rotation.y=this._t-this.dt.alpha+Math.PI/2;break;case this.yt.ii:this.u.rotation.y=this._t-this.dt.alpha-Math.PI/2}else this.u.rotation.y=this._t-this.dt.alpha;if(s&&this.Pt.length()>.001)if(this.u.moveWithCollisions(this.Pt),this.u.position.y>this.I.y){var f=this.u.position.subtract(this.I),o=this.Wt(f);o>=this.g?this.C>0?(0==this.F&&this.A.copyFrom(this.I),this.F=this.F+(this.u.position.y-this.I.y),this.F>this.C&&(this.F=0,this.u.position.copyFrom(this.A),this.hi())):(this.u.position.copyFrom(this.I),this.hi()):(this.F=0,o>this.O?(this.U=0,this.V=!1):this.hi())}else if(this.u.position.y<this.I.y){f=this.u.position.subtract(this.I);this.Vt(f,this.Pt,.001)?(this.V=!0,this.U++,this.U>this.P&&(h=this.L.fall)):this.Wt(f)<=this.O?this.hi():(this.U=0,this.V=!1)}else this.hi();return h},t.prototype.hi=function(){this.$=0,this.U=0,this.V=!1},t.prototype.Nt=function(t){if(this.K)return this.L.idle;this.W=!1,this.X=!1,this.$=0;var i=this.L.idle;if(this.U=0,0===t)this.N=5;else{var s=this.ht*this.k;this.N=s*t+this.k*t*t/2,this.ht=this.ht+t}if(this.N<.01)return i;var n=new h.Vector3(0,-this.N,0);if(1==this.B||this.st||(this.u.rotation.y=this._t-this.dt.alpha),this.u.moveWithCollisions(n),this.u.position.y>this.I.y||this.u.position.y===this.I.y)this.ni();else if(this.u.position.y<this.I.y){var e=this.u.position.subtract(this.I);this.Vt(e,n,.001)||(this.Wt(e)<=this.O?(this.ni(),this.u.position.copyFrom(this.I)):(this.ei(),i=this.L.slideBack))}return i},t.prototype.ni=function(){this.nt++,this.nt>this.et&&(this.K=!0,this.ht=0)},t.prototype.ei=function(){this.K=!1,this.nt=0},t.prototype.Et=function(){0==this.F&&this.u.position.addToRef(this.S,this.dt.target),this.dt.radius>this.dt.lowerRadiusLimit&&(this.R||this.vt)&&this.ri(),this.dt.radius<=this.dt.lowerRadiusLimit?this.q||this.ut||(this.u.visibility=0,this.dt.checkCollisions=!1,this.J=this.B,this.B=0,this.ut=!0):(this.ut=!1,this.B=this.J,this.u.visibility=1,this.dt.checkCollisions=this.rt)},t.prototype.ri=function(){var t=this;this.dt.position.subtractToRef(this.dt.target,this.ot),this.ft.origin=this.dt.target,this.ft.length=this.ot.length(),this.ft.direction=this.ot.normalize();var i=this.pt.multiPickWithRay(this.ft,(function(i){return i!=t.u}));if(this.vt)if(this.ui=this.lt,i.length>0){this.lt=new Array;for(var s=0,h=i;s<h.length;s++){var n=h[s];(n.pickedMesh.isVisible||this.ui.includes(n.pickedMesh))&&(n.pickedMesh.isVisible=!1,this.lt.push(n.pickedMesh))}for(var e=0,r=this.ui;e<r.length;e++){var u=r[e];this.lt.includes(u)||(u.isVisible=!0)}}else{for(var f=0,o=this.ui;f<o.length;f++){(u=o[f]).isVisible=!0}this.ui.length=0}if(this.R&&i.length>0){if(!(1!=i.length||this.fi(i[0].pickedMesh)||i[0].pickedMesh.checkCollisions&&this.dt.checkCollisions))return;for(var c=null,a=0;a<i.length;a++){u=i[a].pickedMesh;if(this.fi(u)){c=i[a].pickedPoint;break}if(u.checkCollisions){c=i[a].pickedPoint;break}}if(null==c)return;var l=this.dt.position.subtract(c),v=l.length();if(this.dt.checkCollisions){var b=void 0;b=v<=1?l.addInPlace(l.normalizeToNew().scaleInPlace(this.ct)):l.normalize().scaleInPlace(v/this.bt),this.dt.position=this.dt.position.subtract(b)}else{b=void 0;b=v<=1?v+this.ct:v/this.bt,this.dt.radius=this.dt.radius-b}}},t.prototype.fi=function(t){return!!t.isVisible&&(0!=t.visibility&&(null==t.material||0==t.material.alphaMode||0!=t.material.alpha))},t.prototype.anyMovement=function(){return this.yt.$t||this.yt.ti||this.yt.ii||this.yt.si||this.yt.Xt||this.yt.Zt},t.prototype.At=function(t){if(t.key&&!t.repeat){switch(t.key.toLowerCase()){case this.L.idleJump.key:this.yt.Ht=!0;break;case"capslock":this.yt.Yt=!this.yt.Yt;break;case"shift":this.yt.Yt=!0;break;case"up":case"arrowup":case this.L.walk.key:this.yt.$t=!0;break;case"left":case"arrowleft":case this.L.turnLeft.key:this.yt.ii=!0;break;case"right":case"arrowright":case this.L.turnRight.key:this.yt.si=!0;break;case"down":case"arrowdown":case this.L.walkBack.key:this.yt.ti=!0;break;case this.L.strafeLeft.key:this.yt.Xt=!0;break;case this.L.strafeRight.key:this.yt.Zt=!0}this.wt=this.anyMovement()}},t.prototype.Ct=function(t){if(t.key){switch(t.key.toLowerCase()){case"shift":this.yt.Yt=!1;break;case"up":case"arrowup":case this.L.walk.key:this.yt.$t=!1;break;case"left":case"arrowleft":case this.L.turnLeft.key:this.yt.ii=!1,this.it=!1;break;case"right":case"arrowright":case this.L.turnRight.key:this.yt.si=!1,this.it=!1;break;case"down":case"arrowdown":case this.L.walkBack.key:this.yt.ti=!1;break;case this.L.strafeLeft.key:this.yt.Xt=!1;break;case this.L.strafeRight.key:this.yt.Zt=!1}this.wt=this.anyMovement()}},t.prototype.enableKeyBoard=function(t){this.Rt=t;var i=this.pt.getEngine().getRenderingCanvas();t?(i.addEventListener("keyup",this.xt,!1),i.addEventListener("keydown",this.Ft,!1)):(i.removeEventListener("keyup",this.xt,!1),i.removeEventListener("keydown",this.Ft,!1))},t.prototype.walk=function(t){this.yt.$t=t},t.prototype.walkBack=function(t){this.yt.ti=t},t.prototype.walkBackFast=function(t){this.yt.ti=t,this.yt.Yt=t},t.prototype.run=function(t){this.yt.$t=t,this.yt.Yt=t},t.prototype.turnLeft=function(t){this.yt.ii=t,t||(this.it=t)},t.prototype.turnLeftFast=function(t){this.yt.ii=t,t||(this.it=t),this.yt.Yt=t},t.prototype.turnRight=function(t){this.yt.si=t,t||(this.it=t)},t.prototype.turnRightFast=function(t){this.yt.si=t,t||(this.it=t),this.yt.Yt=t},t.prototype.strafeLeft=function(t){this.yt.Xt=t},t.prototype.strafeLeftFast=function(t){this.yt.Xt=t,this.yt.Yt=t},t.prototype.strafeRight=function(t){this.yt.Zt=t},t.prototype.strafeRightFast=function(t){this.yt.Zt=t,this.yt.Yt=t},t.prototype.jump=function(){this.yt.Ht=!0},t.prototype.idle=function(){this.yt.reset()},t.prototype.isAg=function(){return this.kt},t.prototype.oi=function(t){var i=this.ci(t);if(i instanceof h.Mesh&&i.skeleton)return i.skeleton;var s=i.getChildMeshes(!1,(function(t){return!!(t instanceof h.Mesh&&t.skeleton)}));return s.length>0?s[0].skeleton:null},t.prototype.ci=function(t){return null==t.parent?t:this.ci(t.parent)},t.prototype.setAvatar=function(t,i){void 0===i&&(i=!1);var s=this.ci(t);return s instanceof h.Mesh?(this.u=s,this.v=this.oi(t),this.kt=this.Tt(t,this.pt.animationGroups,!0),this.L.reset(),this.kt||null==this.v||this.jt(this.v),this.Bt(t),this.setFaceForward(i),!0):(console.error("Cannot move this mesh. The root node of the mesh provided is not a mesh"),!1)},t.prototype.getAvatar=function(){return this.u},t.prototype.setAvatarSkeleton=function(t){this.v=t,null!=this.v&&this.ai(t)?this.kt=!0:this.kt=!1,this.kt||null==this.v||this.jt(this.v)},t.prototype.ai=function(t){var i=this;return t.animations.some((function(t){return i.pt.animationGroups.some((function(i){return i.children.some((function(i){return i.animation==t}))}))}))},t.prototype.getSkeleton=function(){return this.v},t}(),e=function(){function t(){this.$t=!1,this.ti=!1,this.si=!1,this.ii=!1,this.Zt=!1,this.Xt=!1,this.Ht=!1,this.Yt=!1,this.reset()}return t.prototype.reset=function(){this.$t=!1,this.ti=!1,this.si=!1,this.ii=!1,this.Zt=!1,this.Xt=!1,this.Ht=!1,this.Yt=!1},t}(),r=function(){function t(t,i,s){void 0===i&&(i=1),this.name="",this.loop=!0,this.rate=1,this.exist=!1,this.id=t,this.speed=i,this.ds=i,this.key=s,this.dk=s}return t.prototype.reset=function(){this.name="",this.speed=this.ds,this.key=this.dk,this.loop=!0,this.rate=1,this.sound="",this.exist=!1},t}(),u=function(){function t(){this.walk=new r("walk",3,"w"),this.walkBack=new r("walkBack",1.5,"s"),this.walkBackFast=new r("walkBackFast",3,"na"),this.idle=new r("idle",0,"na"),this.idleJump=new r("idleJump",6," "),this.run=new r("run",6,"na"),this.runJump=new r("runJump",6,"na"),this.fall=new r("fall",0,"na"),this.turnLeft=new r("turnLeft",Math.PI/8,"a"),this.turnLeftFast=new r("turnLeftFast",Math.PI/4,"na"),this.turnRight=new r("turnRight",Math.PI/8,"d"),this.turnRightFast=new r("turnRightFast",Math.PI/4,"na"),this.strafeLeft=new r("strafeLeft",1.5,"q"),this.strafeLeftFast=new r("strafeLeftFast",3,"na"),this.strafeRight=new r("strafeRight",1.5,"e"),this.strafeRightFast=new r("strafeRightFast",3,"na"),this.slideBack=new r("slideBack",0,"na")}return t.prototype.reset=function(){for(var t=0,i=Object.keys(this);t<i.length;t++){var s=this[i[t]];s instanceof r&&s.reset()}},t}(),f=function(){this.cameraElastic=!0,this.makeInvisble=!0,this.cameraTarget=h.Vector3.Zero(),this.noFirstPerson=!1,this.topDown=!0,this.turningOff=!0,this.keyboard=!0}}])}));
//# sourceMappingURL=CharacterController.js.map